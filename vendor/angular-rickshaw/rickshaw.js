"use strict";angular.module("angular-rickshaw",[]).directive("rickshaw",["$compile","$window",function(e,r){return{restrict:"EA",scope:{options:"=rickshawOptions",series:"=rickshawSeries",features:"=rickshawFeatures"},link:function(a,i,t){function s(){l.setSize(),l.render()}function n(){if(l?(w=angular.copy(a.options,w),w.element=u[0],w.series=a.series,l.configure(w)):(o=angular.element(i),o.append(u),o.empty(),u=e("<div></div>")(a),o.append(u),w=angular.copy(a.options),w.element=u[0],w.series=a.series,l=new Rickshaw.Graph(w)),a.features){if(a.features.hover){var r={graph:l};r.xFormatter=a.features.hover.xFormatter,r.yFormatter=a.features.hover.yFormatter,r.formatter=a.features.hover.formatter;{new Rickshaw.Graph.HoverDetail(r)}}if(a.features.palette)for(var t=new Rickshaw.Color.Palette({scheme:a.features.palette}),n=0;n<w.series.length;n++)w.series[n].color=t.color()}if(s(),a.features){if(a.features.xAxis){var g={graph:l};if(a.features.xAxis.timeUnit){var p=new Rickshaw.Fixtures.Time;g.timeUnit=p.unit(a.features.xAxis.timeUnit),f||(f=new Rickshaw.Graph.Axis.Time(g),f.render())}else f||(f=new Rickshaw.Graph.Axis.X(g),f.render())}if(a.features.yAxis){var d={graph:l};a.features.yAxis.tickFormat&&(d.tickFormat=Rickshaw.Fixtures.Number[a.features.yAxis.tickFormat]),h||(h=new Rickshaw.Graph.Axis.Y(d),h.render())}if(a.features.legend){if(!c){c=e("<div></div>")(a),o.append(c);var m=new Rickshaw.Graph.Legend({graph:l,element:c[0]});if(a.features.legend.toggle){new Rickshaw.Graph.Behavior.Series.Toggle({graph:l,legend:m})}if(a.features.legend.highlight){new Rickshaw.Graph.Behavior.Series.Highlight({graph:l,legend:m})}}}else c&&(c.remove(),c=null)}}var o,u,c,f,h,l,w,g=a.$watch("options",function(e,r){angular.equals(e,r)||n()},!0),p=a.$watch(function(e){if(e.features&&e.features.directive&&e.features.directive.watchAllSeries){for(var r={},a=0;a<e.series.length;a++)r["series"+a]=e.series[a].data;return r}return e.series[0].data},function(e,r){angular.equals(e,r)||n()},!0),d=a.$watch("features",function(e,r){angular.equals(e,r)||n()},!0);a.$on("$destroy",function(){g(),p(),d()}),angular.element(r).on("resize",function(){a.$broadcast("rickshaw::resize")}),a.$on("rickshaw::resize",function(){s()}),n()},controller:function(e,r,a){}}}]);